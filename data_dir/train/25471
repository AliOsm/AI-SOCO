// 07.11.2017

/*
C. ����� ���������
������������� ����� � ��������� �������� � �����! ��������� ��������� ����� �������� ���� ����� � ��������� �� ����� ����� ������ �������.
����� ������� �� n �������. ��� ��������� �� ���� �������� ������������� ������������� ������:
1.	��� ������ ������� i ���������� ����� ���� �����, ������ �� ���� �������. ��� �������� ������� - pi, ��������, ��� pi = i; 
2.	��� ������ ������� i ���������� ����� ���� ������� j �����, ��� pj = i. 
��������� ���������� ���������� ����� ����� ���������.
���������� - ��� ���������� ����� ������������� ��� (x, y), ��� ���������� ������ �� ������� x,
� �����, ���������������� ����������� �������� (�������� ������� �����������), �������� �� ������� y (1 <= x, y <= n).
��� ��������� �������, ��� ���� ���������� ����� ������������ ������, �� ��������� ����� �������� ���� � ������
(����������, ������� ��� �� �����, ����� ��� ���������).
����� ���������� ����������� ������ ��� ������ ����������� ��������� ����� �����,
����� �������, ������� �������� pi ��� �� ����� ��� ���� ������� �����.
�������, �������� ������������ ������������ ����� �����������, ������� ����� ������ ����������� ������ � ����� ���������.
��� ����� ����������� ����� ����� �����, ����� ���������� ����� ����� ������������ ���������.
�������� ��� ���������, ����� ������������ ���������� �� ����� ��������.
������� ������
� ������ ������ �������� ���� ����� ����� n (1 <= n <= 100000) - ���������� �������.
�� ������ ������ �������� n ����� ����� p1, p2, ..., pn (1 <= pi <= n) - ������� ��������� �����. ��� ��� ����� ��������.
�������� ������
�������� ���� ����� - ������������ ��������� �������� ����������.
�������
������� ������
3
2 1 3
�������� ������
9
������� ������
5
1 5 4 3 2
�������� ������
17
����������
� ������ ������� ��� ����� �������� p2 �� 3 � p3 �� 1, ����� ����� 9 ���: (1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3), (3, 1), (3, 2), (3, 3).
�� ������ ������� ����� �������� p2 �� 4 � p3 �� 5.

*/

/*
�������� ��� ����� (��� �� ������������)
����� ��� ����� ������� � ���������� �� � ����
��������� ����� ��� �� ���� ������
*/


# include <cstdio>
# include <iostream>
# include <algorithm>
# include <queue>
# include <stack>
# include <vector>
# include <map>
# include <set>
# include <cstring>
# include <string>


# define lint __int64


using namespace std;


const int N = 100100;


int n, m, k, t;
int p [N], kol, loop [N];
int len [N];
lint sum, temp;


int main ()
{
# ifndef ONLINE_JUDGE
   freopen ("C.TXT", "r", stdin);
   freopen ("C.OUT", "w", stdout);
# endif

   ios_base::sync_with_stdio (0);

   cin >> n;
   for ( int i (1); i <= n; i++ )
   {
      cin >> p [i];
   }

# ifndef ONLINE_JUDGE
   cout << n << endl << "P   ";
   for ( int i (1); i <= n; i++ )
      cout << p [i] << " ";
   cout << endl;
# endif

   k = 0;
   for ( int i (1), j (0); i <= n; i=j+1 )
   {
      for ( j=i; j <= n; j++ )
         if ( loop [j] == 0 )
         {
            k++;
            loop [j] = k;
            break;
         }

      if ( j > n )
         break;

      int le = 1;
      for ( m=j; p [m] != j; m=p [m] )
         le++,
         loop [p [m]] = k;

      len [k] = le;
   }

# ifndef ONLINE_JUDGE
   cout << k << endl << "LEN   ";
   for ( int i (1); i <= k; i++ )
      cout << len [i] << " ";
   cout << endl << "LOOP   ";
   for ( int i (1); i <= n; i++ )
      cout << loop [i] << " ";
   cout << endl;
# endif

   if ( k == 1 )
   {
      temp = len [1];
      cout << temp * temp;
      return 0;
   }

   int max1 (len [1]), max2 (len [2]);
   int imax1 (1), imax2 (2);
   if ( len [2] > len [1] )
      max1 = len [2], imax1 = 2,
      max2 = len [1], imax2 = 1;

   for ( int i (3); i <= k; i++ )
      if ( len [i] > max1 )
         max2 = max1, imax2 = imax1,
         max1 = len [i], imax1 = i;
      else if ( len [i] > max2 )
         max2 = len [i], imax2 = i;

   len [imax1] += len [imax2],
   len [imax2] = 0;

# ifndef ONLINE_JUDGE
   cout << max1 << "   " << imax1 << endl;
   cout << max2 << "   " << imax2 << endl;
   cout << "LEN   ";
   for ( int i (1); i <= k; i++ )
      cout << len [i] << " ";
   cout << endl;
# endif

   for ( int i (1); i <= k; i++ )
      temp = len [i],
      sum += temp * temp;

   cout << sum;

   return 0;
}
